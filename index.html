<html lang="en">
<head>
    <script defer src="https://cloud.umami.is/script.js" data-website-id="7bdf338b-a1bd-45e0-9afe-d6ae61ed0ec9"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AHMED ACADEMY | Physics Terminal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --theme-red: #ff003c;
            --theme-black: #050505;
            --theme-cyan: #00f3ff;
            --theme-dark: #111111;
        }

        body {
            background-color: var(--theme-black);
            color: #e0e0e0;
            font-family: 'Rajdhani', sans-serif;
            overflow-x: hidden;
            width: 100%;
        }

        /* CRT SCANLINE EFFECT */
        body::before {
            content: " ";
            display: block;
            position: absolute;
            top: 0; left: 0; bottom: 0; right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            z-index: 50;
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
        }

        .font-orbitron { font-family: 'Orbitron', sans-serif; }

        /* HEADER - FULL WIDTH */
        header {
            background: linear-gradient(90deg, var(--theme-red) 0%, #8b0000 100%);
            clip-path: polygon(0 0, 100% 0, 100% 85%, 0 100%);
            border-bottom: 2px solid white;
            width: 100%;
        }

        /* NAV & CARDS */
        .topic-card {
            background: var(--theme-dark);
            border: 1px solid #333;
            transition: 0.3s;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            z-index: 60;
            white-space: nowrap;
            flex-grow: 1;
            text-align: center;
        }

        .topic-card:hover {
            border-color: var(--theme-red);
            transform: translateY(-2px);
            box-shadow: 0 0 15px rgba(255, 0, 60, 0.3);
        }

        .topic-card.active {
            border-bottom: 3px solid var(--theme-red);
            background: #1a1a1a;
            color: var(--theme-red);
        }

        /* EMBEDS - RESPONSIVE 16:9 */
        .slide-embed-container {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 Aspect Ratio */
            height: 0;
            overflow: hidden;
            border: 1px solid #444;
            background: #000;
            z-index: 40;
            width: 100%;
        }
        .slide-embed-container iframe {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
        }

        /* MODAL STYLES */
        #question-modal {
            backdrop-filter: blur(5px);
            background-color: rgba(0, 0, 0, 0.85);
        }

        /* MCQ ANSWER BUTTONS */
        .mcq-option {
            transition: all 0.2s;
            cursor: pointer;
            text-align: left;
        }
        .mcq-option:hover {
            background-color: rgba(0, 243, 255, 0.1);
            border-color: var(--theme-cyan);
        }
        .mcq-correct {
            background-color: rgba(34, 197, 94, 0.2) !important;
            border-color: #22c55e !important;
            color: #4ade80 !important;
        }
        .mcq-wrong {
            background-color: rgba(239, 68, 68, 0.2) !important;
            border-color: #ef4444 !important;
            color: #f87171 !important;
            opacity: 0.6;
        }

        /* SCROLLBAR */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #050505; }
        ::-webkit-scrollbar-thumb { background: var(--theme-red); }
        .level-tab {
    background: var(--theme-dark);
    color: #666;
    border: 1px solid #333;
}
.level-tab:hover {
    color: white;
    border-color: var(--theme-red);
}
.active-tab {
    background: var(--theme-red);
    color: white;
    border-color: var(--theme-red);
}
/* SEARCH */
#search-wrapper {
    position: relative;
}
#search-results {
    position: absolute;
    top: 100%;
    right: 0;
    width: 320px;
    background: #111;
    border: 1px solid var(--theme-red);
    z-index: 9999;
    max-height: 400px;
    overflow-y: auto;
}
.search-result-item {
    padding: 10px 14px;
    cursor: pointer;
    border-bottom: 1px solid #222;
    transition: background 0.2s;
}
.search-result-item:hover {
    background: rgba(255, 0, 60, 0.15);
}
.search-result-item .result-name {
    color: white;
    font-size: 0.8rem;
    font-family: 'Orbitron', sans-serif;
}
.search-result-item .result-meta {
    color: #666;
    font-size: 0.7rem;
    margin-top: 2px;
}

    </style>
</head>
<body class="min-h-screen flex flex-col w-full">

<audio id="ui-click-sound" src="https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3" preload="auto"></audio>

<header class="p-6 sticky top-0 z-50 shadow-lg w-full">
    <div class="w-full flex flex-col md:flex-row justify-between items-center px-4 gap-4">
        <h1 class="text-2xl md:text-4xl font-black tracking-tighter font-orbitron text-white text-center md:text-left">AHMED ACADEMY - PHYSICS</h1>
        <div class="flex items-center gap-3">
            <div id="search-wrapper">
                <input
                    id="search-input"
                    type="text"
                    placeholder="SEARCH SLIDES..."
                    autocomplete="off"
                    class="bg-black border border-gray-700 text-white font-mono text-xs px-4 py-2 w-48 md:w-64 focus:outline-none focus:border-red-500 transition-colors placeholder-gray-600"
                />
                <div id="search-results" class="hidden"></div>
            </div>
            <div class="text-xs font-mono text-white opacity-80 bg-black/20 px-2 py-1 rounded whitespace-nowrap">
                SYSTEM_STATUS: ONLINE // DB_ACADEMY_v6.1
            </div>
        </div>
    </div>
</header>
<div class="w-full bg-black border-b border-gray-800 sticky top-[88px] z-50">
  <div class="flex justify-center gap-0 w-full max-w-xs mx-auto mt-0">
    <button
      id="tab-gcse"
      onclick="loadSlides('gcse')"
      class="level-tab active-tab flex-1 py-3 text-sm font-bold font-orbitron tracking-widest uppercase transition-all">
      GCSE
    </button>
    <button
      id="tab-alevel"
      onclick="loadSlides('alevel')"
      class="level-tab flex-1 py-3 text-sm font-bold font-orbitron tracking-widest uppercase transition-all">
      A-LEVEL
    </button>
  </div>
</div>
<nav class="bg-[#0f0f0f] border-b border-gray-800 sticky top-[88px] z-40 w-full shadow-2xl">
    <div class="w-full p-4">
        <div id="module-nav-container" class="flex flex-wrap gap-2 justify-center w-full">
            </div>
    </div>
</nav>

<div class="w-full px-4 md:px-8 py-6 z-30 relative flex-grow">
    
    <main class="w-full min-h-[600px] relative">
        
        <div id="content-placeholder" class="h-96 flex flex-col items-center justify-center border-2 border-dashed border-gray-800 rounded-lg p-12 text-center mt-10 w-full">
            <div class="text-5xl mb-4 opacity-20">◢◤</div>
            <p class="text-gray-500 font-mono text-lg">ESTABLISHING UPLINK... SELECT MODULE ABOVE.</p>
        </div>

        <div id="topic-content-area" class="hidden w-full transition-all duration-500">
            </div>
        <section class="w-full max-w-4xl mx-auto px-4 py-10 relative z-40">
    <div class="border border-cyan-900 bg-black/80 p-6 shadow-[0_0_30px_rgba(0,255,255,0.15)]">
        <h2 class="text-2xl font-orbitron text-cyan-400 tracking-widest mb-6 border-b border-cyan-800 pb-2">
            > USER_FEEDBACK_LOOP
        </h2>
        
        <form action="https://formspree.io/f/mlgggrar" method="POST" class="space-y-4 font-mono">
            <div>
                <label class="block text-cyan-700 text-xs mb-1 uppercase tracking-widest">User_Identity</label>
                <input type="email" name="email" placeholder="email@domain.com" required
                    class="w-full bg-black border border-cyan-900 p-3 text-cyan-400 focus:outline-none focus:border-cyan-400 transition-colors">
            </div>
            <div>
                <label class="block text-cyan-700 text-xs mb-1 uppercase tracking-widest">Transmission_Data</label>
                <textarea name="message" rows="4" placeholder="Enter feedback or bug report..." required
                    class="w-full bg-black border border-cyan-900 p-3 text-cyan-400 focus:outline-none focus:border-cyan-400 transition-colors"></textarea>
            </div>
            <button type="submit" 
                class="w-full md:w-auto px-8 py-3 bg-cyan-900/30 border border-cyan-500 text-cyan-400 font-bold uppercase tracking-widest hover:bg-cyan-500 hover:text-black transition-all">
                Send_Transmission
            </button>
        </form>
    </div>
</section>

    </main>
</div>
<div id="question-modal" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-4">
    <div class="bg-black border-2 border-cyan-500 w-full max-w-4xl max-h-[90vh] flex flex-col shadow-[0_0_50px_rgba(0,255,255,0.15)] rounded-sm relative">
        
        <div class="bg-cyan-900/40 p-5 border-b border-cyan-700 flex justify-between items-center flex-shrink-0">
            <div>
                <h2 class="text-xl md:text-2xl font-orbitron text-white tracking-widest" id="modal-title">CLASSIFIED QUESTIONS</h2>
                <div class="h-1 w-20 bg-cyan-500 mt-1"></div>
            </div>
            <button onclick="closeQuestions()" class="text-cyan-500 hover:text-white hover:bg-cyan-900/50 rounded-full w-10 h-10 flex items-center justify-center font-bold text-xl transition">✕</button>
        </div>

        <div class="p-6 overflow-y-auto flex-grow font-mono text-sm md:text-base text-gray-300 space-y-8" id="modal-content">
            </div>

        <div class="p-4 border-t border-gray-800 bg-gray-900 flex justify-end flex-shrink-0">
             <button onclick="closeQuestions()" class="text-xs uppercase tracking-widest text-white bg-red-600 hover:bg-red-700 px-6 py-3 font-bold transition rounded-sm">Close Terminal</button>
        </div>
    </div>
</div>

<footer class="mt-auto border-t border-gray-900 p-8 text-center text-xs font-mono text-gray-600 relative z-30 w-full">
    <p> AHMED ACADEMY PHYSICS </p>
</footer>

<script>
    // --- AUDIO ---
    const clickSound = document.getElementById('ui-click-sound');
    function playClickSound() {
        if(clickSound) {
            clickSound.currentTime = 0;
            clickSound.volume = 0.2; 
            clickSound.play().catch(e => {});
        }
    }
 
    // --- APP LOGIC ---
// --- APP LOGIC ---
// --- APP LOGIC ---
let DATABASE = {};
let currentLevel = 'gcse';

async function loadSlides(level) {
  currentLevel = level;
  const placeholder = document.getElementById('content-placeholder');
  const topicContentArea = document.getElementById('topic-content-area');

  topicContentArea.classList.add('hidden');
  placeholder.classList.remove('hidden');
  placeholder.innerHTML = `
    <div class="text-5xl mb-4 opacity-20">◢◤</div>
    <p class="text-gray-500 font-mono text-lg">ESTABLISHING UPLINK...</p>
  `;

  // Update active tab
  document.querySelectorAll('.level-tab').forEach(t => t.classList.remove('active-tab'));
  document.getElementById(`tab-${level}`).classList.add('active-tab');

  // Clear module nav
  document.getElementById('module-nav-container').innerHTML = '';

  try {
    const res = await fetch(`/.netlify/functions/slides?level=${level}`);
    if (!res.ok) throw new Error(`HTTP ${res.status}`);
    DATABASE = await res.json();
    buildNav();
    placeholder.innerHTML = `
      <div class="text-5xl mb-4 opacity-20">◢◤</div>
      <p class="text-gray-500 font-mono text-lg">UPLINK ESTABLISHED. SELECT MODULE ABOVE.</p>
    `;
  } catch (err) {
    placeholder.innerHTML = `
      <div class="text-5xl mb-4 opacity-20">⚠</div>
      <p class="text-red-500 font-mono text-lg">DATABASE ERROR: ${err.message}</p>
    `;
  }
}

function buildNav() {
  const navContainer = document.getElementById('module-nav-container');
  navContainer.innerHTML = '';
  Object.keys(DATABASE).forEach(key => {
    const card = document.createElement('div');
    card.className = 'topic-card px-4 py-3 rounded-sm font-bold text-sm tracking-widest uppercase border border-gray-800 flex items-center justify-center';
    card.innerHTML = `<span class="opacity-50 mr-2 text-xs">◢</span> ${key}`;
    card.setAttribute('data-key', key);
    card.addEventListener('click', () => {
      playClickSound();
      document.querySelectorAll('.topic-card').forEach(c => c.classList.remove('active'));
      card.classList.add('active');
      revealContent(key);
    });
    navContainer.appendChild(card);
  });
}

// Keep your existing revealContent and createSlideEmbed functions exactly as they are
function revealContent(topicKey) {
    const data = DATABASE[topicKey];
    if (!data) return;
    const contentPlaceholder = document.getElementById('content-placeholder');
    const topicContentArea = document.getElementById('topic-content-area');
    contentPlaceholder.classList.add('hidden');
    topicContentArea.classList.remove('hidden');

    let html = `
        <div class="mb-6 border-b border-red-900 pb-2">
            <h2 class="text-3xl font-black font-orbitron tracking-tighter">${data.title}</h2>
            <p class="text-xs font-mono text-gray-500 mt-1 uppercase tracking-widest">AHMED ACADEMY // SECURE_CLEARANCE_ENABLED</p>
        </div>
    `;

    for (const [sectionName, items] of Object.entries(data.sections)) {
        html += `
            <div class="mb-10">
                <h3 class="text-xl font-bold mb-4 text-white font-orbitron tracking-tight flex items-center border-l-4 border-cyan-500 pl-3">
                    ${sectionName.toUpperCase()}
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    ${items.map(item => createSlideEmbed(item.link, item.name)).join('')}
                </div>
            </div>
        `;
    }
    topicContentArea.innerHTML = html;
}
// --- SEARCH ---
const searchInput = document.getElementById('search-input');
const searchResults = document.getElementById('search-results');

function buildSearchIndex() {
    const index = [];
    for (const [moduleKey, moduleData] of Object.entries(DATABASE)) {
        for (const [section, items] of Object.entries(moduleData.sections)) {
            for (const item of items) {
                index.push({
                    name: item.name,
                    section: section,
                    module: moduleKey,
                    link: item.link,
                    level: currentLevel
                });
            }
        }
    }
    return index;
}

searchInput.addEventListener('input', () => {
    const query = searchInput.value.trim().toLowerCase();
    searchResults.innerHTML = '';

    if (query.length < 2) {
        searchResults.classList.add('hidden');
        return;
    }

    const index = buildSearchIndex();
    const matches = index.filter(item => item.name.toLowerCase().includes(query));

    if (matches.length === 0) {
        searchResults.innerHTML = `<div class="search-result-item"><span class="result-name text-gray-500">No results found</span></div>`;
        searchResults.classList.remove('hidden');
        return;
    }

    matches.slice(0, 8).forEach(item => {
        const div = document.createElement('div');
        div.className = 'search-result-item';
        div.innerHTML = `
            <div class="result-name">${item.name.toUpperCase()}</div>
            <div class="result-meta">${item.module} › ${item.section}</div>
        `;
        div.addEventListener('click', () => {
            playClickSound();
            searchResults.classList.add('hidden');
            searchInput.value = '';

            // Switch level if needed
            if (item.level !== currentLevel) {
                loadSlides(item.level).then(() => openSlideFromSearch(item));
            } else {
                openSlideFromSearch(item);
            }
        });
        searchResults.appendChild(div);
    });

    searchResults.classList.remove('hidden');
});

function openSlideFromSearch(item) {
    // Activate the correct module tab
    document.querySelectorAll('.topic-card').forEach(c => {
        c.classList.remove('active');
        if (c.getAttribute('data-key') === item.module) {
            c.classList.add('active');
        }
    });
    revealContent(item.module);

    // Scroll to the matching slide
    setTimeout(() => {
        const allTitles = document.querySelectorAll('#topic-content-area a');
        for (const el of allTitles) {
            if (el.textContent.trim().toUpperCase() === item.name.toUpperCase()) {
                el.closest('div.group')?.scrollIntoView({ behavior: 'smooth', block: 'center' });
                el.closest('div.group')?.classList.add('ring-2', 'ring-red-500');
                setTimeout(() => el.closest('div.group')?.classList.remove('ring-2', 'ring-red-500'), 3000);
                break;
            }
        }
    }, 300);
}

// Close dropdown when clicking outside
document.addEventListener('click', (e) => {
    if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
        searchResults.classList.add('hidden');
    }
});
loadSlides('gcse');
    // Embed Creator
    const createSlideEmbed = (url, name) => {
        const embedUrl = url.includes('/pub') ? url.replace('/pub', '/embed') : url;
        const safeName = name.replace(/'/g, "\\'");
        
        return `
            <div class="group flex flex-col h-full bg-[#111] border border-[#333] hover:border-red-500 transition-all duration-300 shadow-lg">
                <div class="p-3 border-b border-[#222]">
                     <a href="${url}" target="_blank" class="text-xs text-cyan-500 font-orbitron font-bold tracking-wider truncate hover:underline hover:text-white transition-colors block" title="OPEN FULLSCREEN">
                   ${name.toUpperCase()} ↗
                </a>
                </div>
                <div class="slide-embed-container bg-black">
                    <iframe src="${embedUrl}" frameborder="0" loading="lazy" allowfullscreen="true"></iframe>
                </div>
            </div>
        `;
    };
</script>
</body>
</html>
